{% extends "base.html" %}

{% block title %}{{ action }} Movement - Inventory Management System{% endblock %}

{% block content %}
<h1>{{ action }} Movement</h1>
<p>{{ "Update movement information" if movement else "Record a new inventory movement" }}</p>

<p>
    <a href="{{ url_for('movements') }}" class="btn btn-secondary">Back to Movements</a>
</p>

<form method="POST">
    <label for="product_id">Product *</label>
    <select id="product_id" name="product_id" required>
        <option value="">Select a product</option>
        {% for product in products %}
        <option value="{{ product.product_id }}" 
                {{ 'selected' if movement and movement.product_id == product.product_id else '' }}>
            {{ product.name }} ({{ product.product_id }})
        </option>
        {% endfor %}
    </select>

    <label for="qty">Quantity *</label>
    <input type="number" 
           id="qty" 
           name="qty" 
           value="{{ movement.qty if movement else '' }}"
           min="1"
           required
           placeholder="Enter quantity">

    <label for="from_location">From Location</label>
    <select id="from_location" name="from_location">
        <option value="">Select source location (optional)</option>
        {% for location in locations %}
        <option value="{{ location.location_id }}" 
                {{ 'selected' if movement and movement.from_location == location.location_id else '' }}>
            {{ location.name }} ({{ location.location_id }})
        </option>
        {% endfor %}
    </select>
    <small>Leave empty for stock-in operations</small>

    <label for="to_location">To Location</label>
    <select id="to_location" name="to_location">
        <option value="">Select destination location (optional)</option>
        {% for location in locations %}
        <option value="{{ location.location_id }}" 
                {{ 'selected' if movement and movement.to_location == location.location_id else '' }}>
            {{ location.name }} ({{ location.location_id }})
        </option>
        {% endfor %}
    </select>
    <small>Leave empty for stock-out operations</small>

    <label for="notes">Notes</label>
    <textarea id="notes" 
              name="notes" 
              rows="3"
              placeholder="Enter any additional notes about this movement (optional)">{{ movement.notes if movement else '' }}</textarea>

    <div class="card">
        <h3>Movement Types:</h3>
        <ul>
            <li><strong>Stock In:</strong> Leave "From Location" empty, select "To Location"</li>
            <li><strong>Stock Out:</strong> Select "From Location", leave "To Location" empty</li>
            <li><strong>Transfer:</strong> Select both "From Location" and "To Location"</li>
        </ul>
    </div>

    <p>
        <a href="{{ url_for('movements') }}" class="btn btn-secondary">Cancel</a>
        <button type="submit" class="btn btn-success">{{ action }} Movement</button>
    </p>
</form>
{% endblock %}
